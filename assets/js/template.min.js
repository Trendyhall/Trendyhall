function UserLogout(){setCookie("user-id",1,{"max-age":0}),localStorage.removeItem("user-first-leter"),window.location.replace("/")}function setCookie(e,t,a={}){(a={path:"/",...a}).expires instanceof Date&&(a.expires=a.expires.toUTCString());let o=encodeURIComponent(e)+"="+encodeURIComponent(t);for(let e in a){o+="; "+e;let t=a[e];!0!==t&&(o+="="+t)}document.cookie=o}function getCookie(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function DtabseInit(){firebase.initializeApp({apiKey:"AIzaSyBk0QIQKsrOwNwbjrClrS0kinGEY_I4YzE",authDomain:"trendyhall-37f5c.firebaseapp.com",databaseURL:"https://trendyhall-37f5c-default-rtdb.europe-west1.firebasedatabase.app",projectId:"trendyhall-37f5c",storageBucket:"trendyhall-37f5c.appspot.com",messagingSenderId:"1035638959257",appId:"1:1035638959257:web:2b871ccf8c8162750e9c08",measurementId:"G-9WZXTDWNGS"}),firebase.analytics()}DtabseInit(),document.addEventListener("DOMContentLoaded",()=>{let e=new class{constructor(){}UserLogin(e,t,a,o){fetch("/user/login",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({phone:e,password:t})}).then(e=>{if(e.ok)return e.text();o(e.text())}).then(e=>{0!=e&&a(e)})}GetUserFirstLetter(e,t,a){fetch("/user/get-user-name",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({uuid:e})}).then(e=>{if(e.ok)return e.text();a(e.text())}).then(e=>{0!=e&&t(e[0])})}};!function(){document.querySelector(".icon-cart").setAttribute("data-qty",localStorage.getItem("user-cart-count"));let t=getCookie("user-id");if(t){let a=document.querySelector(".icon-profile");a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-circle" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/></svg>',a.removeAttribute("data-bs-toggle"),a.removeAttribute("data-bs-target"),a.setAttribute("onclick",'location.href="/profile"'),function(t){let a=localStorage.getItem("user-first-leter");null!=a?document.querySelector(".icon-profile").setAttribute("data-qty",a):e.GetUserFirstLetter(t,e=>{document.querySelector(".icon-profile").setAttribute("data-qty",e),localStorage.setItem("user-first-leter",e)},e=>{console.error(e)});null!=(a=localStorage.getItem("user-cart-count"))&&document.querySelector(".icon-cart").setAttribute("data-qty",a)}(t)}else!function(){let t=document.forms.login,a=t.phone.value;t.phone.oninput=(()=>{let e=t.phone;if(/[^0-9+]/.test(e.value)){let t=e.selectionStart-1;e.value=e.value.replace(/[^0-9+]/g,""),e.setSelectionRange(t,t)}"+"==e.value[0]?e.value.length<=12&&(a=e.value):e.value.length<=11&&(a=e.value),e.value=a;/\+7\d{10}|8\d{10}/.test(e.value)&("8"==e.value[0]&11==e.value.length|"+"==e.value[0]&12==e.value.length)?(e.classList.add("is-valid"),e.classList.remove("is-invalid")):(e.classList.add("is-invalid"),e.classList.remove("is-valid"))});t.password.value;t.password.oninput=(()=>{let e=t.password;if(/[^0-9a-zA-Zа-яА-Я_]/.test(e.value)){let t=e.selectionStart-1;e.value=e.value.replace(/[^0-9a-zA-Zа-яА-Я_]/g,""),e.setSelectionRange(t,t)}e.value.length<=16&&(a=e.value),e.value=a;/[0-9a-zA-Zа-яА-Я_]{6,16}/.test(e.value)&e.value.length>=6&e.value.length<=16?(e.classList.add("is-valid"),e.classList.remove("is-invalid")):(e.classList.add("is-invalid"),e.classList.remove("is-valid"))}),t.addEventListener("submit",function(a){a.preventDefault(),a.stopPropagation(),/\+7\d{10}|8\d{10}/.test(t.phone.value)&("8"==t.phone.value[0]&11==t.phone.value.length|"+"==t.phone.value[0]&12==t.phone.value.length)&&/[0-9a-zA-Zа-яА-Я_]/.test(t.password.value)&t.password.value.length>=6&t.password.value.length<=16&&function(t,a){let o=document.forms.login;e.UserLogin(t,a,e=>{o.rememberme.checked?setCookie("user-id",e,{"max-age":864e3}):setCookie("user-id",e),o.submit()},e=>{console.error(e)})}(t.phone.value,t.password.value)},!1)}()}()});